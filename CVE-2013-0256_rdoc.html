<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>CVE-2013-0256 - rdoc 6.5.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./CONTRIBUTING_rdoc.html">CONTRIBUTING</a>
    <li><a href="./CVE-2013-0256_rdoc.html">CVE-2013-0256</a>
    <li><a href="./ExampleRDoc_rdoc.html">ExampleRDoc</a>
    <li><a href="./History_rdoc.html">History</a>
    <li><a href="./LEGAL_rdoc.html">LEGAL</a>
    <li><a href="./LICENSE_rdoc.html">LICENSE</a>
    <li><a href="./README_rdoc.html">README</a>
    <li><a href="./RI_rdoc.html">RI</a>
    <li><a href="./TODO_rdoc.html">TODO</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page CVE-2013-0256.rdoc">

<h1 id="label-RDoc+2.3.0+through+3.12+XSS+Exploit"><a href="RDoc.html"><code>RDoc</code></a> 2.3.0 through 3.12 XSS Exploit<span><a href="#label-RDoc+2.3.0+through+3.12+XSS+Exploit">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p><a href="RDoc.html"><code>RDoc</code></a> documentation generated by rdoc 2.3.0 through rdoc 3.12 and prereleases up to rdoc 4.0.0.preview2.1 are vulnerable to an XSS exploit.  This exploit may lead to cookie disclosure to third parties.</p>

<p>The exploit exists in darkfish.js which is copied from the <a href="RDoc.html"><code>RDoc</code></a> install location to the generated documentation.</p>

<p><a href="RDoc.html"><code>RDoc</code></a> is a static documentation generation tool.  Patching the library itself is insufficient to correct this exploit.  Those hosting rdoc documentation will need to apply the following patch.  If applied while ignoring whitespace, this patch will correct all affected versions:</p>

<pre>diff --git darkfish.js darkfish.js
index 4be722f..f26fd45 100644
--- darkfish.js
+++ darkfish.js
@@ -109,13 +109,15 @@ function hookSearch() {
 function highlightTarget( anchor ) {
   console.debug( &quot;Highlighting target &#39;%s&#39;.&quot;, anchor );

-  $(&quot;a[name=&quot; + anchor + &quot;]&quot;).each( function() {
-    if ( !$(this).parent().parent().hasClass(&#39;target-section&#39;) ) {
-      console.debug( &quot;Wrapping the target-section&quot; );
-      $(&#39;div.method-detail&#39;).unwrap( &#39;div.target-section&#39; );
-      $(this).parent().wrap( &#39;&lt;div class=&quot;target-section&quot;&gt;&lt;/div&gt;&#39; );
-    } else {
-      console.debug( &quot;Already wrapped.&quot; );
+  $(&quot;a[name]&quot;).each( function() {
+    if ( $(this).attr(&quot;name&quot;) == anchor ) {
+      if ( !$(this).parent().parent().hasClass(&#39;target-section&#39;) ) {
+        console.debug( &quot;Wrapping the target-section&quot; );
+        $(&#39;div.method-detail&#39;).unwrap( &#39;div.target-section&#39; );
+        $(this).parent().wrap( &#39;&lt;div class=&quot;target-section&quot;&gt;&lt;/div&gt;&#39; );
+      } else {
+        console.debug( &quot;Already wrapped.&quot; );
+      }
     }
   });
 };</pre>

<p><a href="RDoc.html"><code>RDoc</code></a> 3.9.5, 3.12.1 and <a href="RDoc.html"><code>RDoc</code></a> 4.0.0.rc.2 and newer are not vulnerable to this exploit.</p>

<p>This exploit was discovered by Evgeny Ermakov &lt;corwmh@gmail.com&gt;.</p>

<p>This vulnerability has been assigned the CVE identifier CVE-2013-0256.</p>

</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.5.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

