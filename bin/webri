#!/usr/bin/env ruby

# A console application to display Ruby HTML documentation.

require 'optparse'
require_relative '../lib/rdoc/web_ri'

options = {}

parser = OptionParser.new

parser.version = RDoc::VERSION
parser.banner = <<-BANNER
Command to open the web page for Ruby documentation
(page, class, module, or method).

Usage: #{parser.program_name} [options] name

  where name specifies one or more pages, classes, modules, or methods.

If name specifies a single item, the page for that item is opened;
if it specifies multiple items, the names of those specific items are displayed,
and the user may choose among them.

BANNER

parser.on('-h', '--help', 'Prints this help.') do
  puts parser
  exit
end
parser.on('-v', '--version', 'Prints the version of webri.') do
  puts RDoc::VERSION
  exit
end
parser.on('-r', '--release=STR',
          'Sets desired documentation release to STR.',
          "If not given, uses the release of the installed Ruby (#{RUBY_VERSION}).",
          'If given and not valid, the valid releases are displayed,',
          'and the user may choose among them.',
) do |release|
  options[:release] = release
end
parser.parse!

error_message = case ARGV.size
when 0
  'No name given.'
when 1
  nil
else
  'Multiple names given.'
end
raise ArgumentError.new(error_message) if error_message

target_name = ARGV.shift

web_ri = RDoc::WebRI.new(target_name, options)
